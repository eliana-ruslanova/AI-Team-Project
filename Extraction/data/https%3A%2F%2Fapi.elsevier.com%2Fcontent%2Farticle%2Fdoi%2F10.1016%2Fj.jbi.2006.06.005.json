{"scopus-eid": "2-s2.0-34248346643", "originalText": "serial JL 272371 291210 291682 291870 291901 31 80 Journal of Biomedical Informatics JOURNALBIOMEDICALINFORMATICS 2006-06-27 2006-06-27 2010-10-07T10:23:12 1-s2.0-S1532046406000669 S1532-0464(06)00066-9 S1532046406000669 10.1016/j.jbi.2006.06.005 S300 S300.1 FULL-TEXT 1-s2.0-S1532046407X00364 2015-05-15T06:30:58.184067-04:00 0 0 20070601 20070630 2007 2006-06-27T00:00:00Z articleinfo crossmark dco dateupdated tomb dateloaded datesearch indexeddate issuelist volumelist yearnav articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright dateloadedtxt docsubtype doctype doi eid ewtransactionid hubeid issfirst issn issnnorm itemstage itemtransactionid itemweight oauserlicense openaccess openarchive pg pgfirst pglast pii piinorm pubdateend pubdatestart pubdatetxt pubyr sortorder srctitle srctitlenorm srctype subheadings volfirst volissue webpdf webpdfpagecount figure body mmlmath acknowledge affil articletitle auth authfirstini authfull authkeywords authlast footnotes primabst ref alllist content oa subj ssids 1532-0464 15320464 40 40 3 3 Volume 40, Issue 3 12 325 331 325 331 200706 June 2007 2007-06-01 2007-06-30 2007 article fla Copyright \u00a9 2006 Elsevier Inc. All rights reserved. FEATUREGUIDEDCLUSTERINGMULTIDIMENSIONALFLOWCYTOMETRYDATASETS ZENG Q 1 Introduction 2 Background 2.1 Flow cytometry 2.2 Cluster number estimation 2.3 Histogram feature guidance 2.4 SiZer 3 Methods 3.1 Microsphere preparation 3.2 Determining microsphere number 3.3 Detection antibodies 3.4 Flow cytometry 3.5 FG-guided clustering 3.6 Partition index (PI)-guided clustering 4 Results 4.1 Cell cluster simulation 4.2 Comparison of primary and alternative algorithms 4.3 Statistical comparison 5 Discussion Acknowledgments References SHAPIRO 2003 H PRACTICALFLOWCYTOMETRY EVERITT 1979 169 181 B LANGE 2004 1299 1323 T GUEDALIA 1999 521 540 I BELLOTTI 1997 1221 1227 M RAVDIN 1993 74 80 P BODDY 2001 195 209 L YOUNG 1977 935 941 I FU 1993 365 373 L KOHONEN 1990 1464 1481 T CHARALAMPIDIS 2005 1856 1865 D ZHONG 2005 255 265 W ZHONG 2005 790 798 S LASZLO 2006 533 543 M GARGE 2005 S10 N DUONG 2006 923 930 L MONTGOMERY 2005 19 24 E LEE 2005 312 320 S FAMILI 2004 1535 1545 A DUDOIT 2002 S BENHUR 2002 6 17 A BENSAID 1996 112 123 A WAND 1995 M KERNELSMOOTHING HARDLE 1990 223 232 W CHAUDHURI 1999 807 882 P ZENG 2002 929 933 Q BRECHER 1956 1439 1449 G BIKOUE 1996 137 147 A CHRISTOPHERSON 2006 241 251 R HABIB 2006 124 135 L ZENGX2007X325 ZENGX2007X325X331 ZENGX2007X325XQ ZENGX2007X325X331XQ 2013-08-22T00:00:29Z Full http://www.elsevier.com/open-access/userlicense/1.0/ OA-Window ElsevierBranded item S1532-0464(06)00066-9 S1532046406000669 1-s2.0-S1532046406000669 10.1016/j.jbi.2006.06.005 272371 2010-11-08T20:10:20.545321-05:00 2007-06-01 2007-06-30 1-s2.0-S1532046406000669-main.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/MAIN/application/pdf/3ffdc172d1b4a2c3402d2bd35f99ab03/main.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/MAIN/application/pdf/3ffdc172d1b4a2c3402d2bd35f99ab03/main.pdf main.pdf pdf true 559806 MAIN 7 1-s2.0-S1532046406000669-main_1.png https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/PREVIEW/image/png/b9c554f1f8e987ded4b3283d56450ae3/main_1.png https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/PREVIEW/image/png/b9c554f1f8e987ded4b3283d56450ae3/main_1.png main_1.png png 64817 849 656 IMAGE-WEB-PDF 1 1-s2.0-S1532046406000669-si3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/STRIPIN/image/gif/bfd9d966c299ff0385b1f609ec864e1b/si3.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/STRIPIN/image/gif/bfd9d966c299ff0385b1f609ec864e1b/si3.gif si3 si3.gif gif 464 17 74 ALTIMG 1-s2.0-S1532046406000669-si2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/STRIPIN/image/gif/02cc507258880e48a4e933a95f56eaeb/si2.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/STRIPIN/image/gif/02cc507258880e48a4e933a95f56eaeb/si2.gif si2 si2.gif gif 536 17 91 ALTIMG 1-s2.0-S1532046406000669-si1.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/STRIPIN/image/gif/ef92d611d024963c022fcfc8e90a8aad/si1.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/STRIPIN/image/gif/ef92d611d024963c022fcfc8e90a8aad/si1.gif si1 si1.gif gif 913 17 223 ALTIMG 1-s2.0-S1532046406000669-gr4.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr4/DOWNSAMPLED/image/jpeg/dc84d211886f1b4c03868f9bf71a6910/gr4.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr4/DOWNSAMPLED/image/jpeg/dc84d211886f1b4c03868f9bf71a6910/gr4.jpg gr4 gr4.jpg jpg 59046 299 369 IMAGE-DOWNSAMPLED 1-s2.0-S1532046406000669-gr4.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr4/THUMBNAIL/image/gif/75b31340ef79368c5482ec04796ab922/gr4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr4/THUMBNAIL/image/gif/75b31340ef79368c5482ec04796ab922/gr4.sml gr4 gr4.sml sml 4402 93 115 IMAGE-THUMBNAIL 1-s2.0-S1532046406000669-gr1.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr1/DOWNSAMPLED/image/jpeg/33b78d1e9065579ae9f1b34a35471aa1/gr1.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr1/DOWNSAMPLED/image/jpeg/33b78d1e9065579ae9f1b34a35471aa1/gr1.jpg gr1 gr1.jpg jpg 26970 288 369 IMAGE-DOWNSAMPLED 1-s2.0-S1532046406000669-gr1.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr1/THUMBNAIL/image/gif/7ce9f70e91565b6208fd6cbc7d7da3ea/gr1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr1/THUMBNAIL/image/gif/7ce9f70e91565b6208fd6cbc7d7da3ea/gr1.sml gr1 gr1.sml sml 1692 93 119 IMAGE-THUMBNAIL 1-s2.0-S1532046406000669-gr2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr2/DOWNSAMPLED/image/gif/1965781d13ab560bf5f41b033c34fccf/gr2.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr2/DOWNSAMPLED/image/gif/1965781d13ab560bf5f41b033c34fccf/gr2.gif gr2 gr2.gif gif 8591 203 800 IMAGE-DOWNSAMPLED 1-s2.0-S1532046406000669-gr2.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr2/THUMBNAIL/image/gif/3e05ae007aa61b9f134154fb5628a191/gr2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr2/THUMBNAIL/image/gif/3e05ae007aa61b9f134154fb5628a191/gr2.sml gr2 gr2.sml sml 595 32 125 IMAGE-THUMBNAIL 1-s2.0-S1532046406000669-gr5.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr5/DOWNSAMPLED/image/jpeg/083879d3538be9c21843497b25334721/gr5.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr5/DOWNSAMPLED/image/jpeg/083879d3538be9c21843497b25334721/gr5.jpg gr5 gr5.jpg jpg 54083 293 749 IMAGE-DOWNSAMPLED 1-s2.0-S1532046406000669-gr5.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr5/THUMBNAIL/image/gif/b0814dbc26e65e5fb079bb332fc435ef/gr5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr5/THUMBNAIL/image/gif/b0814dbc26e65e5fb079bb332fc435ef/gr5.sml gr5 gr5.sml sml 2066 49 125 IMAGE-THUMBNAIL 1-s2.0-S1532046406000669-gr3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr3/DOWNSAMPLED/image/gif/5401bb383352446766bea715c234d9e7/gr3.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr3/DOWNSAMPLED/image/gif/5401bb383352446766bea715c234d9e7/gr3.gif gr3 gr3.gif gif 20237 436 791 IMAGE-DOWNSAMPLED 1-s2.0-S1532046406000669-gr3.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1532046406000669/gr3/THUMBNAIL/image/gif/b324082a544097daa02698910a9a2fbe/gr3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1532046406000669/gr3/THUMBNAIL/image/gif/b324082a544097daa02698910a9a2fbe/gr3.sml gr3 gr3.sml sml 1209 69 125 IMAGE-THUMBNAIL YJBIN 1297 S1532-0464(06)00066-9 10.1016/j.jbi.2006.06.005 Elsevier Inc. Fig. 1 Schematic of histogram feature-guided clustering. Dual parameter data suggest two primary clusters (Clusters 1 and 2); however, more detailed examination of the X dimension shows that Cluster 2 is actually composed of two distinct populations (Populations 2 and 3) represented by the peaks x 1 and x 2. Similarly, the Y dimension has two distinct peaks (y 1 and y 2). The absence of a cluster centered at x 2 is an indication of an insufficient number of clusters and suggest that the missing cluster may be centered on x 2. Fig. 2 The microspheres were constructed with systematic variation along three dimensions: (A) Microsphere size (forward scatter), (B) surface protein density, and (C) detecting fluorochrome wavelength. The microspheres were 1, 2, 3, and 5\u03bcm in diameter. Surface protein concentration was empirically determined using chemical stoichiometry of the reaction and empirical testing using protein-specific antibodies. Three fluorochromes, fluorescein, phycoerythrin, and PE-Cy5 with limited spectral overlap were used. Fig. 3 An illustration of the nonparametric multi-dimensional datasets generated by the microspheres. The parameters detected by the flow cytometer included fluorescence intensity in (A) green (510nm), (B) orange (565nm), and (C) red (610nm) wavelengths as well as (D) size (forward scatter), and (E) granularity (side scatter). Fig. 4 Three-dimensional illustration of a sample dataset (same dataset as Fig. 3) with projections in single dimensions. The dataset was comprised of four known microsphere clusters of various sizes: 3465, 2760, 1043, and 765. Fig. 5 Comparison clustering performance of the (A) FG-guided and B) PI-guided algorithms. The linear regression for each algorithm is shown in the red lines. The confidence limits (green lines) and prediction bands (blue lines) are also shown. Feature-guided clustering of multi-dimensional flow cytometry datasets Qing T. Zeng a c \u204e qzeng@dsg.harvard.edu Juan Pablo Pratt b Jane Pak b Dino Ravnic b Harold Huss b Steven J. Mentzer b c a Decision Systems Group, Brigham and Women\u2019s Hospital, 310 Thorn Building, 75 Francis Street, Harvard Medical School, Boston, MA 02115, USA b Departments of Surgery, Brigham and Women\u2019s Hospital, Harvard Medical School, Boston, MA, USA c Harvard-MIT Division of Human Sciences and Technology, Cambridge, MA, USA \u204e Corresponding author. Fax: +1 617 739 3672. Abstract Background Flow cytometry produces large multi-dimensional datasets of the physical and molecular characteristics of individual cells. The objective of this study was to simplify the cytometry datasets by arranging or clustering \u201cobjects\u201d (cells) into a smaller number of relatively homogeneous groups (clusters) on the basis of interobject similarities and dissimilarities. Results The algorithm was designed to be driven by histogram features; that is, the relevant single parameter histogram features were used to guide multidimensional k-means clustering without an a priori estimate of cluster number. To test this approach, we simulated cell-derived datasets using protein-coated microspheres (artificial \u201ccells\u201d). The microspheres were constructed to provide 119 populations in 40 samples. The feature-guided (FG) approach accurately identified 100% of the predetermined cluster combinations. In contrast, an approach based on the partition index (PI) cluster validity measure accurately identified 83.2% of the clusters. Direct comparisons of the two methods indicated that the FG method was significantly more accurate than PI in identifying both the number of clusters and the number of objects within the clusters (p <.0001). Conclusion We conclude that parameter feature analysis can be used to effectively guide k-means clustering of flow cytometry datasets. Keywords Flow cytometry Kernel smoothing Clustering Microspheres 1 Introduction Flow cytometry is the science of measuring the molecular, physical, and chemical properties of individual cells as they pass through a flow chamber and are interrogated by one or more lasers [1]. The flow cytometer simultaneously and quantitatively measures parameters such as size, granularity, and surface molecule expression for each cell [1]. Because a typical experiment can analyze 10,000 or more cells, meaningful data processing requires the grouping or clustering of the data. Computational clustering algorithms have offered a promising analytic tool for these large datasets. Obtaining meaningful grouping of data, however, requires a method to estimate the optimal number of clusters [2\u20134]. Overclustering of the data can result in numerous groupings with many similarities and few meaningful differences. Underclustering, on the other hand, results in the dilution of important distinctions by the grouping of less related data. Ideally, the actual number of clusters would be data-driven and independent of a priori assumptions. In this report, we describe a histogram feature-guided (FG) 1 Abbreviations used: FITC, Fluorescein isothiocyanate; FS, forward light scatter; PI, partition index; PE, phycoerythrin; SS, side light scatter; FG, feature-guided. 1 approach for clustering flow cytometry data. This approach was tested using a microsphere simulation of multi-dimensional cell-based datasets. In contrast to cell analyses, the microspheres were constructed so that the computational algorithm could be tested against a known \u201cactual\u201d cluster number. When compared to a representative validity measure, FG-guided clustering was significantly more efficient at providing an estimate of cluster number. 2 Background 2.1 Flow cytometry Flow cytometry is the only currently available high throughput technology that can measure multiple physical and molecular characteristics of individual cells. The large multi-parameter datasets generated by conventional flow cytometry have led to a variety of attempts to improve data analysis. The analytic approaches have included neural networks, support vector machines, principal components, cluster analysis, self-organizing maps (SOM), discriminant regression trees (CART), rule-based systems, fuzzy logic, and other statistical methods [5\u20137]. The flow cytometry samples have included fungal spores [8], bacteria [9], phytoplankton [7], peripheral blood cells [9], and bone marrow aspirates [5,6,10]. 2.2 Cluster number estimation A variety of clustering algorithms have been applied to biomedical data [11\u201316]. The k-means algorithm is a widely used unsupervised learning algorithm that groups data in a prescribed number (k) of clusters [17]. When applied to flow cytometry datasets, the cluster result is highly dependent upon the number of initial clusters k. To arrive at a data-driven number of clusters, there are two general approaches. The first approach starts with a large number of clusters. In the extreme case, each data point can be considered a cluster. The clusters are then merged according to statistically based criteria. For example, two clusters are merged if the first cluster falls within a standard deviation of the second cluster. The recent algorithms proposed by Montgomery et al. [18] and Lee and Crawford [19] are both extensions and variations of this approach. Another approach is an iterative procedure that starts with a relatively small k value, but sequentially increases the number of clusters. At each level, the procedure evaluates the validity of the result using a statistical test. The actual number of clusters can be inferred from the level at which the best validity measure is obtained. Many validity-based methods have been proposed [20\u201322]. The partition index (PI), for example, calculates the ratio of the compactness and separation of the clusters [23]. To the extent that our feature-guided approach gradually increases the number of clusters and checks the clusters\u2019 validity, our algorithm falls within this category. 2.3 Histogram feature guidance An important concept in histogram feature guidance is that the distance or similarity analyzed in unidimensional and multidimensional space are non-equivalent. Clustering based upon multidimensional features is often capable of uncovering clusters that are difficult to detect in any single dimension. In contrast, the multidimensional approach can overlook meaningful dissimilarities in only a single dimension\u2014a particularly common problem when the cluster number is underestimated. A unidimensional analysis will, by definition, be unable to identify shared features. A detailed analysis of each dimension can, however, identify cluster characteristics that might otherwise be diluted in a multidimensional calculation. The relative advantage of a single parameter analysis can be illustrated schematically (Fig. 1 ). Visual inspection of the two dimensional data suggest two primary clusters (Clusters 1 and 2). A closer examination of the data based on the X dimension shows that Cluster 2 is actually composed of two distinct populations (Populations 2 and 3) represented by the peaks x 1 and x 2. Similarly, the Y dimension has two distinct peaks (y 1 and y 2). A plausible assumption is that the clusters are centered on these peaks. Cluster 1 is indeed centered on x 1 and y 2; however, Cluster 2 is centered on x 3 and y 1, but not on x 2. The absence of a cluster at x 2 is an indication of an insufficient number of clusters. An additional benefit of the single parameter analysis is that the location of the unexplained peaks can be used to identify the candidate clusters for subdivision. For example, the data in Clusters 1 and 2 suggest that a subcluster centered on x 2 could only exist within Cluster 2. Importantly, this unidimensional analysis\u2014applied to each dimension of the multi-dimensional dataset\u2014is used to guide the clustering of the integrated dataset. 2.4 SiZer The identification of histogram features, such as the location of a biologically meaningful peak, is nontrivial. Biologic data are often composed of complex cell populations that produce multimodal histograms. The application of parametric tests, including measures of central tendency and measures of dispersion, are rarely useful in these complex datasets. An alternative approach is provided by kernel smoothing. Kernel smoothing is a general-purpose statistical technique for highlighting structure in nonparametric datasets [24]. The spatial resolution of kernel smoothing is determined by the bandwidth: a narrow bandwidth provides a highly resolved density estimation whereas a wide bandwidth produces a highly smoothed density estimation [25]. The SiZer map, introduced by Chaudhuri and Marron [26], provides a visual depiction of the features of the family of kernel density estimates. We have previously used SiZer maps to measure the dissimilarity between flow cytometry histogram distributions [27]. Given a location x and a given bandwidth value, SiZer is a statistical methodology that can evaluate whether the histogram is increasing or decreasing. Although SiZer maps produce a multi-bandwidth family of curves, this study empirically selected a bandwidth that reliably distinguished major features. We postulate that in multidimensional clustering, the omission of minor or ambiguous features in one dimension would be generally compensated by information from other dimensions. 3 Methods 3.1 Microsphere preparation The artificial cells were developed from commercially available microspheres (Bangs laboratories, Fishers, IN; Polysciences Inc Warrington, PA, USA) formulated with carboxylic acid groups incorporated into the microsphere surface. To provide a defined protein surface, murine immunoglobulin (IgM; eBioscience, San Diego, California, USA) was covalently linked to 6\u03bcm, 3\u03bcm, 2\u03bcm, and 1\u03bcm microspheres using a water soluble carbodiimide (1-ethyl-3-(3-dimethylaminopropyl) carbodiimide hydrochloride (EDAC)) reaction. Briefly, the microspheres were washed in an activation buffer (MES, pH 6) and reacted with EDAC (PolyLink; Bangs) and various concentrations of IgM for 30min at 25\u00b0C. The reaction was quenched with a 35\u03bcM glycine buffer. The microspheres were washed in a 1%(w/v) bovine serum albumin blocking buffer(pH 7) and stored at 4\u00b0C. To confirm the reaction stoichiometry, the density of covalently linked protein was confirmed by quantitative flow cytometry. 3.2 Determining microsphere number Electronic counting of the microspheres was performed using a Coulter Z2 Particle Analyzer (Beckman Coulter, Miami, FL, USA). The Coulter Z2, based on the Coulter principle [28], counted the microspheres by measuring changes in electrical resistance produced by the nonconductive microspheres suspended in a standard electrolyte solution (Isoton II; Beckman Coulter). A 100\u03bcm aperture was used with constant voltage settings (gain 128, current 0.707, preamp gain 179.20). Cell minimum and maximum diameter settings were modified for the analysis of the various sized microspheres. 3.3 Detection antibodies The surface IgM was detected using a goat anti-mouse Ig fluorescein isothiocyanate (FITC) antibody (Southern Biotech, Birmingham, AL, USA), goat anti-mouse Ig phycoerythrin (PE) antibody (Southern Biotech) and a rat anti-mouse IgM PE-Cy5 conjugate (eBioscience, San Diego, CA, USA). 3.4 Flow cytometry Samples were analyzed using an Epics XL-MCL flow cytometer (Beckman Coulter, Miami, FL) The artificial cells were analyzed on an Epics XL (Beckman Coulter) equipped with a single laser with excitation wavelength at 488nm and three emission detectors. Gain settings were calibrated to four peak Rainbow calibration particles (Spherotech; Libertyville, IL, USA). During the experiments the laser power, photomultiplier tube voltage, light scatter, and fluorescent gains were kept constant. A total of 10,000 events were acquired from each sample. The data was processed using WinList 5.0 (Verity; Topsham, ME, USA) and exported to Microsoft Excel (Redmond, WA, USA) for further analysis. 3.5 FG-guided clustering The algorithm first extracts peaks from each of the multiple dimensions using SiZer and then uses the maximum number of peaks from a dimension as the initial cluster number. The centroid locations of the resultant clusters are compared with the peak locations. If unmatched peaks and clusters exist, the unmatched clusters are merged for further clustering. In the second stage of clustering, the cluster number is first set to 2 and iteratively increased until each peaks is matched to the a cluster\u2019s centroid. The clustering was conducted in the following steps: 1. For multi-dimensional data a, we used SiZer to identify peak locations in each dimension. We used the software developed by J.S. Marron (http://www.stat.unc.edu/faculty/marron.html). First, SiZer created a family of n histograms (which were smoothed at n even levels from minimum to maximum) for each dimension. Level m histogram h was selected per dimension. In this analysis, n =11 and m =5. We considered x to be a peak location in h when: h \u2032 ( x ) = 0 and h ( x ) > h ( x - 1 ) Let p mij represent the location of peak i in dimension j with m level of smoothing. 2. The number of peaks was counted in each dimension (np j ) and the cluster number k was set to be the maximum number of peaks in a dimension: k = max ( np j ) 3. The k-means algorithm was used to partition a into k clusters (c) and we calculate the centroid of each cluster c i . Let s ij represent the cluster c i \u2019s centroid location in dimension j. 4. In each dimension j, the nearest peak p mxj was located for every cluster centroid s yj . If the difference between the peak and centroid location was below a threshold t, p mxj and s yj were considered to be a match: \u2223p mxj \u2212s yj \u2223< t (t was set to 45, which is approximately 50% of the spread (width) of the smallest peaks in this dataset.) Let UP represent the set of unmatched peaks, UC the set of unmatched clusters and MC the set of matched clusters. 5. If UP was empty, the clustering processing was terminated. If it was not empty, the unmatched clusters in UC were merged, which form the new data a for analysis. Let cluster number k =2. 6. As in step 3, the k-means algorithm was used to partition a into k clusters (c) and calculate the centroid of each cluster c i . 7. As in step 4, each peak in UP was checked for a match to the clusters c. 8. If unmatched peaks remained, k =k+1 and steps 6\u20138 were repeated. The number k was then passed to the k-means algorithm for clustering. For distance measure, we chose squared Euclidean distance after experimenting with cityblock, cosine, and correlation. 3.6 Partition index (PI)-guided clustering As an alternative, we also calculated the validity measure PI [23] for i clusters (i =2\u201310). Since PI generally decreases as i increases, the actual value of i is suppose to correlate with a deceleration in the rate of decrease in PI. Thus, we considered k to be actual number of clusters if: PI \u2033 ( k ) = 0 The number k was then passed to the k-means algorithm for clustering. We also used squared Euclidean distance. 4 Results 4.1 Cell cluster simulation The analysis of living cell-derived datasets is limited by feature variation within \u201cnaturally\u201d occurring clusters. Further, it is difficult to selectively vary attributes of living cells. To provide clusters with predetermined size and attributes, we constructed protein-linked microspheres (artificial \u201ccells\u201d) that varied in size, protein density and detection wavelength (Fig. 2 ). These \u201cgold standard\u201d microspheres provided 864 potential feature combinations. The microspheres were then combined to create datasets that approximated the nonparametric complexity of cell-derived flow cytometry analyses. A total of 119 populations were constructed in 40 samples. In a single dimension, the histograms were commonly multimodal (Fig. 3 ). Even when presented in three dimensions, cluster identification was nontrivial. For example, the dataset shown in Fig. 4 comprised four distinct clusters. 4.2 Comparison of primary and alternative algorithms To test the primary FG-guided approach, we compared the performance of our algorithm to the alternative PI-guided approach on the defined microsphere dataset. Because the smallest microspheres bordered on the signal detection limits of the flow cytometer, clusters representing electronic noise were removed from the analysis. There were 119 known populations; FG returned 119 clusters and PI returned 99 clusters. The 119 clusters from the primary algorithm and 99 clusters from the alternate algorithm were compared to the gold standard populations. When a population was partitioned into 2 or more clusters, the largest cluster was considered to be a match of that population. When 2 or more populations were grouped into one cluster, the cluster was considered to a match of the largest population. We then compared the number of cells in each population to their matching clusters. Errors in clustering were reflected in an erroneous cell count and greater numerical variability. 4.3 Statistical comparison Because the microspheres provided a predetermined cluster size, the observed cluster size could be plotted against the predicted (or \u201cknown\u201d) cluster size. The primary algorithm was highly accurate in identifying the clusters with a strong observed to predicted correlation (R =0.845; p <0.001) (Fig. 5 A). The confidence limits and predictive bands showed relatively narrow variance. In contrast, the alternative algorithm showed a poorer correlation (R =0.662; p <0.001) with significantly greater variance (Fig. 5B). The primary algorithm was significantly more accurate in identifying cluster number and cluster size than the alternative algorithm (p <.0001). 5 Discussion Although flow cytometry produces large multi-dimensional datasets with a significant potential for data mining and knowledge discovery, the technology has been limited by current approaches to data analysis. While past developmental studies have clustered flow cytometry data [7,29\u201331], the issues of cluster number estimation and gold standards have remained largely unresolved. In this report, we describe an algorithm termed FG-guided clustering that uses histogram features extracted from each dimension to guide k-means clustering. When tested on a flow cytometry dataset, the FG-guided method was significantly more accurate than the alternative PI-guided algorithm. The FG-guided method correctly identified not only all the hidden microsphere populations, but also the number of cells within the clusters. The evaluation results suggest that, when used in conjunction with cluster algorithms like k-means, histogram features are helpful in determining the actual number of clusters. Because clustering algorithms measure distance or similarity in multi-dimensional space, clusters that are only separable in one of the dimensions (e.g. Populations 2 and 3 in Fig. 1) can be underclustered. Whereas identifying the number of peaks in each dimension does not directly provide an estimate of the actual number of cluster, a lack of peak-cluster correspondence does appear to be a good indicator of underclustering. One of the major obstacles in developing clustering algorithms for flow cytometry data is the inherent variability and instability in naturally occurring cell populations. Our developmental approach used the construction of protein-coated microspheres to simulated cell-derived flow cytometry data. An advantage of this approach was that each microsphere feature was independently verified and stable over time. In addition, the multiple experimental parameters of the microspheres allowed us to progressively increase the complexity of the clustering tasks. A potential weakness of our algorithm is the dependence on SiZer for identifying structure within the histogram data. Even an advanced statistical methodology like SiZer depends upon underlying histogram structure; however, histogram structure may not be identifiable in other datasets. In some applications, it is possible that datasets will contain few clues to be discovered using histogram analyses. Finally, the FG algorithm was implemented using two empirically derived parameters. The first parameter was the bandwidth or degree of spatial resolution provided by the kernel smoothing procedure. While the multi-bandwidth information provided by SiZer presents a comprehensive picture on how significant a peak is, it is necessary to select a specific bandwidth, i.e. a level of smoothing, to guide the clustering process. This level can be adjusted for different datasets and applications. We used a mid-range bandwidth setting to capture the major histogram features, but avoid insignificant histogram variation. In datasets with highly resolved histogram structure, a lower bandwidth may be more appropriate. The second parameter was the matching threshold of cluster centroid and peak point location. In this study we used an absolute value. Future implementations will explore defining the threshold as a percentage (e.g. 25%) of the peak spread or based on other statistical features of the peak. Acknowledgments Q.T.Z. designed the FG algorithm, evaluation analysis and drafted the manuscript. J.P.P. carried out the cytometry experiments and evaluated the algorithm. J.P. implemented the FG and PI algorithm. D.R. and H.H. participated in the cytometry experiments and algorithm evaluation. S.M. conceived of the study, and participated in its design and coordination and drafted the manuscript. The authors thank Dr. Howard Shapiro and Dr. Edgar Milford for their contributions to this work. References [1] H.M. Shapiro Practical flow cytometry 4th ed. 2003 John Wiley & Sons, Inc. New York [2] B. Everitt Unsolved problems in cluster analysis Biometrics 35 1979 169 181 [3] T. Lange V. Roth M.L. Braun J.M. Buhmann Stability-based validation of clustering solutions Neural Comput 16 6 2004 1299 1323 [4] I.D. Guedalia M. London M. Werman An on-line agglomerative clustering method for nonstationary data Neural Comput 11 2 1999 521 540 [5] M. Bellotti B. Elsner A. Paez De Lima H. Esteva A.M. Marchevsky Neural networks as a prognostic tool for patients with non-small cell carcinoma of the lung Modern Pathol 10 12 1997 1221 1227 [6] P.M. Ravdin G.M. Clark J.J. Hough M.A. Owens W.L. McGuire Neural network analysis of DNA flow cytometry histograms Cytometry 14 1 1993 74 80 [7] L. Boddy M.F. Wilkins C.W. Morris Pattern recognition in flow cytometry Cytometry 44 3 2001 195 209 [8] I.T. Young Proof without prejudice: use of the Kolmogorov\u2013Smirnov test for the analysis of histograms from flow systems and other sources J Histochem Cytochem 25 7 1977 935 941 [9] L. Fu M. Yang R. Braylan N. Benson Real-time adaptive clustering of flow cytometric data Pattern Recogn 26 1993 365 373 [10] T. Kohonen The self-organizing map P IEEE 78 1990 1464 1481 [11] D. Charalampidis A modified k-means algorithm for circular invariant clustering IEEE Trans Pattern Anal Mach Intell 27 12 2005 1856 1865 [12] W. Zhong G. Altun R. Harrison P.C. Tai Y. Pan Improved k-means clustering algorithm for exploring local protein sequence motifs representing common structural property IEEE Trans Nanobioscience 4 3 2005 255 265 [13] S. Zhong Efficient streaming text clustering Neural Netw 18 5\u20136 2005 790 798 [14] M. Laszlo S. Mukherjee A genetic algorithm using hyper-quadtrees for low-dimensional k-means clustering IEEE Trans Pattern Anal Mach Intell 28 4 2006 533 543 [15] N.R. Garge G.P. Page A.P. Sprague B.S. Gorman D.B. Allison Reproducible clusters from microarray research: whither? BMC Bioinformatics 6 Suppl 2 2005 S10 [16] L. Duong F. Cheriet H. Labelle Three-dimensional classification of spinal deformities using fuzzy clustering Spine 31 8 2006 923 930 [17] MacQueen JB. Some methods for classification and analysis of multivariate observations. In: Proceedings of fifth berkeley symposium on mathematical statistics and probability, vol. 1. Berkeley: University of California Press; 1967. p. 281\u201397. [18] E.B. Montgomery Jr. H. Huang A. Assadi Unsupervised clustering algorithm for N-dimensional data J Neurosci Methods 144 1 2005 19 24 [19] S. Lee M.M. Crawford Unsupervised multistage image classification using hierarchical clustering with a Bayesian similarity measure IEEE Trans Image Process. 14 3 2005 312 320 [20] A.F. Famili G. Liu Z. Liu Evaluation and optimization of clustering in gene expression data analysis Bioinformatics 20 10 2004 1535 1545 [21] S. Dudoit J. Fridlyand A prediction-based resampling method for estimating the number of clusters in a dataset Genome Biol. 3 7 2002 RESEARCH0036 [22] A. Ben-Hur A. Elisseeff I. Guyon A stability based method for discovering structure in clustered data Pac Symp Biocomput 2002 6 17 [23] A.M. Bensaid L.O. Hall J.C. Bezdek L.P. Clarke M.L. Silbiger J.A. Arrington Validity-guided (re)clustering with applications to imagesegmentation IEEE Trans Fuzzy Systems 4 2 1996 112 123 [24] M.P. Wand M.C. Jones Kernel Smoothing 1995 CRC Press [25] W. Hardle J.S. Marron M.P. Wand Bandwidth choice for density derivatives J R Stat Soc 52 1990 223 232 [26] P. Chaudhuri J.S. Marron SiZer for exploration of structures in curves J Am Stat Assoc 94 1999 807 882 [27] Q. Zeng M. Wand A.J. Young J. Rawn E.L. Milford S.J. Mentzer R.A. Greenes Matching of flow-cytometry histograms using information theory in feature space Proc AMIA Symp 2002 929 933 [28] G. Brecher M. Schneiderman G.Z. Williams Evaluation of electronic red blood cell counter Am J Clin Pathol 26 1956 1439 1449 [29] A. Bikoue F. George P. Poncelet M. Mutin G. Janossy J. Sampol Quantitative analysis of leukocyte membrane antigen expression: normal adult values Cytometry 26 2 1996 137 147 [30] R.I. Christopherson K. Stoner N. Barber L. Belov A. Woolfson M. Scott L. Bendall S.P. Mulligan Classification of AML using a monoclonal antibody microarray Methods Mol Med 125 2006 241 251 [31] L.K. Habib W.G. Finn Unsupervised immunophenotypic profiling of chronic lymphocytic leukemia Cytometry B Clin Cytom 70B 3 2006 124 135", "scopus-id": "34248346643", "pubmed-id": "16901761", "coredata": {"eid": "1-s2.0-S1532046406000669", "dc:description": "Abstract Background Flow cytometry produces large multi-dimensional datasets of the physical and molecular characteristics of individual cells. The objective of this study was to simplify the cytometry datasets by arranging or clustering \u201cobjects\u201d (cells) into a smaller number of relatively homogeneous groups (clusters) on the basis of interobject similarities and dissimilarities. Results The algorithm was designed to be driven by histogram features; that is, the relevant single parameter histogram features were used to guide multidimensional k-means clustering without an a priori estimate of cluster number. To test this approach, we simulated cell-derived datasets using protein-coated microspheres (artificial \u201ccells\u201d). The microspheres were constructed to provide 119 populations in 40 samples. The feature-guided (FG) approach accurately identified 100% of the predetermined cluster combinations. In contrast, an approach based on the partition index (PI) cluster validity measure accurately identified 83.2% of the clusters. Direct comparisons of the two methods indicated that the FG method was significantly more accurate than PI in identifying both the number of clusters and the number of objects within the clusters (p <.0001). Conclusion We conclude that parameter feature analysis can be used to effectively guide k-means clustering of flow cytometry datasets.", "openArchiveArticle": "true", "prism:coverDate": "2007-06-30", "openaccessUserLicense": "http://www.elsevier.com/open-access/userlicense/1.0/", "prism:aggregationType": "Journal", "prism:url": "https://api.elsevier.com/content/article/pii/S1532046406000669", "dc:creator": [{"@_fa": "true", "$": "Zeng, Qing T."}, {"@_fa": "true", "$": "Pratt, Juan Pablo"}, {"@_fa": "true", "$": "Pak, Jane"}, {"@_fa": "true", "$": "Ravnic, Dino"}, {"@_fa": "true", "$": "Huss, Harold"}, {"@_fa": "true", "$": "Mentzer, Steven J."}], "link": [{"@_fa": "true", "@rel": "self", "@href": "https://api.elsevier.com/content/article/pii/S1532046406000669"}, {"@_fa": "true", "@rel": "scidir", "@href": "https://www.sciencedirect.com/science/article/pii/S1532046406000669"}], "dc:format": "application/json", "openaccessType": "Full", "pii": "S1532-0464(06)00066-9", "prism:volume": "40", "prism:publisher": "Elsevier Inc.", "dc:title": "Feature-guided clustering of multi-dimensional flow cytometry datasets", "prism:copyright": "Copyright \u00a9 2006 Elsevier Inc. All rights reserved.", "openaccess": "1", "prism:issn": "15320464", "prism:issueIdentifier": "3", "dcterms:subject": [{"@_fa": "true", "$": "Flow cytometry"}, {"@_fa": "true", "$": "Kernel smoothing"}, {"@_fa": "true", "$": "Clustering"}, {"@_fa": "true", "$": "Microspheres"}], "openaccessArticle": "true", "prism:publicationName": "Journal of Biomedical Informatics", "prism:number": "3", "openaccessSponsorType": "ElsevierBranded", "prism:pageRange": "325-331", "prism:endingPage": "331", "prism:coverDisplayDate": "June 2007", "prism:doi": "10.1016/j.jbi.2006.06.005", "prism:startingPage": "325", "dc:identifier": "doi:10.1016/j.jbi.2006.06.005", "openaccessSponsorName": null}, "objects": {"object": [{"@category": "thumbnail", "@height": "17", "@width": "74", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-si3.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "464", "@ref": "si3", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "17", "@width": "91", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-si2.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "536", "@ref": "si2", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "17", "@width": "223", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-si1.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "913", "@ref": "si1", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "299", "@width": "369", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr4.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "59046", "@ref": "gr4", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "93", "@width": "115", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr4.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "4402", "@ref": "gr4", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "288", "@width": "369", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr1.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "26970", "@ref": "gr1", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "93", "@width": "119", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr1.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "1692", "@ref": "gr1", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "203", "@width": "800", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr2.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "8591", "@ref": "gr2", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "32", "@width": "125", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr2.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "595", "@ref": "gr2", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "293", "@width": "749", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr5.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "54083", "@ref": "gr5", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "49", "@width": "125", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr5.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "2066", "@ref": "gr5", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "436", "@width": "791", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr3.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "20237", "@ref": "gr3", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "69", "@width": "125", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1532046406000669-gr3.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "1209", "@ref": "gr3", "@mimetype": "image/gif"}]}, "link": {"@rel": "abstract", "@href": "https://api.elsevier.com/content/abstract/scopus_id/34248346643"}}