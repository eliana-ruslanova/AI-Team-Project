{"scopus-eid": "2-s2.0-33344456468", "originalText": "serial JL 271362 291210 291685 291687 291859 291928 31 80 Journal of the American Society for Mass Spectrometry JOURNALAMERICANSOCIETYFORMASSSPECTROMETRY 2006-02-07 2006-02-07 2010-11-14T06:28:54 1-s2.0-S1044030505009840 S1044-0305(05)00984-0 S1044030505009840 10.1016/j.jasms.2005.11.024 S300 S300.1 FULL-TEXT 1-s2.0-S1044030506X0171X 2015-05-15T04:35:14.279692-04:00 0 0 20060301 20060331 2006 2006-02-07T00:00:00Z articleinfo crossmark dco dateupdated tomb dateloaded datesearch indexeddate issuelist volumelist yearnav articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright dateloadedtxt docsubtype doctype doi eid ewtransactionid hubeid issfirst issn issnnorm itemstage itemtransactionid itemweight oauserlicense openaccess openarchive pg pgfirst pglast pii piinorm pubdateend pubdatestart pubdatetxt pubyr sectiontitle sortorder srctitle srctitlenorm srctype subheadings volfirst volissue webpdf webpdfpagecount figure e-component body mmlmath acknowledge affil appendices articletitle auth authfirstini authfull authlast footnotes primabst pubtype ref alllist content oa subj ssids 1044-0305 10440305 17 17 3 3 Volume 17, Issue 3 19 459 468 459 468 200603 March 2006 2006-03-01 2006-03-31 2006 Articles article fla Copyright \u00a9 2006 American Society for Mass Spectrometry. Published by Elsevier B.V. All rights reserved. ALGORITHMSFORAUTOMATICINTERPRETATIONHIGHRESOLUTIONMASSSPECTRA KAUR P Experimental Modeling Noise Isotopic Distribution Identification Charge State Determination The Matched Filter (MF) Method for Charge State Determination Alignment Between Theoretical and Experimental Isotopic Distribution Results and Discussion Conclusions Acknowledgments Supplementary data References MARSHALL 1990 A FOURIERTRANSFORMSINNMROPTICALANDMASSSPECTROMETRY AMSTER 1996 1325 1337 I KARAS 1987 53 68 M FENN 1989 64 71 J BUDNIK 2004 203 212 B OCONNOR 2003 128 132 P MOYER 2003 6449 6454 S HENRY 1991 5447 5449 K SHEN 2001 3011 3021 Y AEBERSOLD 2003 685 695 R MCLAFFERTY 1994 379 386 F KELLEHER 2004 196A 203A N KELLEHER 1999 806 812 N ZUBAREV 1998 3265 3266 R MANN 1989 1702 1708 M REINHOLD 1992 207 215 B HENRY 1990 490 492 K SENKO 1995 229 233 M SENKO 1995 52 56 M ZHANG 1998 225 233 Z HORN 2000 320 332 D HAYKIN 1994 413 418 S COMMUNICATIONSSYSTEMS DUDA 2001 325 326 R PATTERNCLASSIFICATION ROCKWOOD 1996 2027 2030 A BEAVIS 1993 496 497 R ZUBAREV 1996 4060 4063 R KAUR 2004 2756 2762 P POOR 1994 53 H INTRODUCTIONSIGNALDETECTIONESTIMATIONSPRINGERTEXTSINELECTRICALENGINEERING ROEPSTORFF 1984 601 P KAURX2006X459 KAURX2006X459X468 KAURX2006X459XP KAURX2006X459X468XP http://www.elsevier.com/open-access/userlicense/1.0/ OA-Window Full ElsevierBranded 2013-07-19T08:44:29Z item S1044-0305(05)00984-0 S1044030505009840 1-s2.0-S1044030505009840 10.1016/j.jasms.2005.11.024 271362 2010-12-25T11:52:53.705523-05:00 2006-03-01 2006-03-31 1-s2.0-S1044030505009840-main.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/MAIN/application/pdf/022270662567bf2d62052bcd5ac35242/main.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/MAIN/application/pdf/022270662567bf2d62052bcd5ac35242/main.pdf main.pdf pdf true 463879 MAIN 10 1-s2.0-S1044030505009840-main_1.png https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/PREVIEW/image/png/6aedd68ed6d50bcf1454c1d9015f16c3/main_1.png https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/PREVIEW/image/png/6aedd68ed6d50bcf1454c1d9015f16c3/main_1.png main_1.png png 86871 849 656 IMAGE-WEB-PDF 1 1-s2.0-S1044030505009840-si12.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/fd9cd84d7ae886c09fc2dc4e2d8aa0a8/si12.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/fd9cd84d7ae886c09fc2dc4e2d8aa0a8/si12.gif si12 si12.gif gif 1331 34 350 ALTIMG 1-s2.0-S1044030505009840-si10.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/e8456193ba231e1976c0c03bbf922663/si10.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/e8456193ba231e1976c0c03bbf922663/si10.gif si10 si10.gif gif 895 26 199 ALTIMG 1-s2.0-S1044030505009840-si9.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/cead0d360633c15f10c0a27d86ad6358/si9.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/cead0d360633c15f10c0a27d86ad6358/si9.gif si9 si9.gif gif 1372 53 196 ALTIMG 1-s2.0-S1044030505009840-si8.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/1cfda6454d01cc6dbe2ad71edd5148a4/si8.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/1cfda6454d01cc6dbe2ad71edd5148a4/si8.gif si8 si8.gif gif 3507 123 318 ALTIMG 1-s2.0-S1044030505009840-si7.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/f1339088640faafea238a48a57d49ce1/si7.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/f1339088640faafea238a48a57d49ce1/si7.gif si7 si7.gif gif 1282 52 179 ALTIMG 1-s2.0-S1044030505009840-si6.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/6f78367ed06626d0fc03b058a6b0af42/si6.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/6f78367ed06626d0fc03b058a6b0af42/si6.gif si6 si6.gif gif 606 25 133 ALTIMG 1-s2.0-S1044030505009840-si5.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/02041dc4bed8489e2e885fd0513522e6/si5.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/02041dc4bed8489e2e885fd0513522e6/si5.gif si5 si5.gif gif 2860 72 343 ALTIMG 1-s2.0-S1044030505009840-si4.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/0ff8b0778f9179126e433100219d0590/si4.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/0ff8b0778f9179126e433100219d0590/si4.gif si4 si4.gif gif 811 26 171 ALTIMG 1-s2.0-S1044030505009840-si3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/ca632259fc351c5e5aa4cbe6111907e4/si3.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/ca632259fc351c5e5aa4cbe6111907e4/si3.gif si3 si3.gif gif 766 26 164 ALTIMG 1-s2.0-S1044030505009840-si11.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/e02f21721c42bac5cb0578409341e345/si11.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/e02f21721c42bac5cb0578409341e345/si11.gif si11 si11.gif gif 489 15 150 ALTIMG 1-s2.0-S1044030505009840-si2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/c6cf6ce6c23c76949da55182a918aacb/si2.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/c6cf6ce6c23c76949da55182a918aacb/si2.gif si2 si2.gif gif 693 15 178 ALTIMG 1-s2.0-S1044030505009840-si1.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/STRIPIN/image/gif/7ed21bdc6056a126b5dbfbef646c4ed0/si1.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/STRIPIN/image/gif/7ed21bdc6056a126b5dbfbef646c4ed0/si1.gif si1 si1.gif gif 972 37 204 ALTIMG 1-s2.0-S1044030505009840-mmc1.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/mmc1/MAIN/application/pdf/41e44f8aca91719875550ca24dbb8043/mmc1.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/mmc1/MAIN/application/pdf/41e44f8aca91719875550ca24dbb8043/mmc1.pdf mmc1 mmc1.pdf pdf false 29038 APPLICATION 1-s2.0-S1044030505009840-mmc2.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/mmc2/MAIN/application/pdf/43621f2b3ac8b6418ef5425f7023385b/mmc2.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/mmc2/MAIN/application/pdf/43621f2b3ac8b6418ef5425f7023385b/mmc2.pdf mmc2 mmc2.pdf pdf false 216369 APPLICATION 1-s2.0-S1044030505009840-gr5.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr5/DOWNSAMPLED/image/jpeg/5d46a00a6976e57abae2ff973730ca3a/gr5.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr5/DOWNSAMPLED/image/jpeg/5d46a00a6976e57abae2ff973730ca3a/gr5.jpg gr5 gr5.jpg jpg 56378 588 342 IMAGE-DOWNSAMPLED 1-s2.0-S1044030505009840-gr5.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr5/THUMBNAIL/image/gif/9b5e0a7babc99ef4f77c80aa7b5da7e2/gr5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr5/THUMBNAIL/image/gif/9b5e0a7babc99ef4f77c80aa7b5da7e2/gr5.sml gr5 gr5.sml sml 1147 93 54 IMAGE-THUMBNAIL 1-s2.0-S1044030505009840-gr4.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr4/DOWNSAMPLED/image/jpeg/4986a2834f87b0815a8015129b7b9e81/gr4.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr4/DOWNSAMPLED/image/jpeg/4986a2834f87b0815a8015129b7b9e81/gr4.jpg gr4 gr4.jpg jpg 35662 337 339 IMAGE-DOWNSAMPLED 1-s2.0-S1044030505009840-gr4.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr4/THUMBNAIL/image/gif/f603b5102e77f9f3bad572db9ede1bc7/gr4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr4/THUMBNAIL/image/gif/f603b5102e77f9f3bad572db9ede1bc7/gr4.sml gr4 gr4.sml sml 1485 93 94 IMAGE-THUMBNAIL 1-s2.0-S1044030505009840-gr6.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr6/DOWNSAMPLED/image/jpeg/7975282fbdc8ed91915254eefacf381a/gr6.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr6/DOWNSAMPLED/image/jpeg/7975282fbdc8ed91915254eefacf381a/gr6.jpg gr6 gr6.jpg jpg 44867 323 367 IMAGE-DOWNSAMPLED 1-s2.0-S1044030505009840-gr6.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr6/THUMBNAIL/image/gif/6f52b019a3f9b1766d5139e13d5eb661/gr6.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr6/THUMBNAIL/image/gif/6f52b019a3f9b1766d5139e13d5eb661/gr6.sml gr6 gr6.sml sml 2170 93 106 IMAGE-THUMBNAIL 1-s2.0-S1044030505009840-gr1.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr1/DOWNSAMPLED/image/jpeg/4ae366027e99d528ce5ec702e52542ee/gr1.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr1/DOWNSAMPLED/image/jpeg/4ae366027e99d528ce5ec702e52542ee/gr1.jpg gr1 gr1.jpg jpg 68200 699 357 IMAGE-DOWNSAMPLED 1-s2.0-S1044030505009840-gr1.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr1/THUMBNAIL/image/gif/0a0a55bbb87c6a55387d3c8f78f69d21/gr1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr1/THUMBNAIL/image/gif/0a0a55bbb87c6a55387d3c8f78f69d21/gr1.sml gr1 gr1.sml sml 1420 92 47 IMAGE-THUMBNAIL 1-s2.0-S1044030505009840-gr3.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr3/DOWNSAMPLED/image/jpeg/113d4913acc73fce9d001c4621d82aed/gr3.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr3/DOWNSAMPLED/image/jpeg/113d4913acc73fce9d001c4621d82aed/gr3.jpg gr3 gr3.jpg jpg 137037 1431 596 IMAGE-DOWNSAMPLED 1-s2.0-S1044030505009840-gr3.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr3/THUMBNAIL/image/gif/f5f9abdf22fd4d4304af29d4537af4d9/gr3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr3/THUMBNAIL/image/gif/f5f9abdf22fd4d4304af29d4537af4d9/gr3.sml gr3 gr3.sml sml 867 94 39 IMAGE-THUMBNAIL 1-s2.0-S1044030505009840-gr2.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr2/DOWNSAMPLED/image/jpeg/ebb113edf14b384e6ec1551af2afe1e4/gr2.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr2/DOWNSAMPLED/image/jpeg/ebb113edf14b384e6ec1551af2afe1e4/gr2.jpg gr2 gr2.jpg jpg 59983 583 357 IMAGE-DOWNSAMPLED 1-s2.0-S1044030505009840-gr2.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S1044030505009840/gr2/THUMBNAIL/image/gif/1389c8a6c354ca4b2279d05e27fdd9af/gr2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S1044030505009840/gr2/THUMBNAIL/image/gif/1389c8a6c354ca4b2279d05e27fdd9af/gr2.sml gr2 gr2.sml sml 1017 93 57 IMAGE-THUMBNAIL JAM 6718 S1044-0305(05)00984-0 10.1016/j.jasms.2005.11.024 American Society for Mass Spectrometry Figure 1 (a) Top down spectrum of bovine carbonic anhydrase; (b) zoomed in view of the baseline (black), modeled noise baseline (white); (c) zoomed-in view of the spectrum, \u201cup\u201d and \u201cdown\u201d arrows denote the start and end of an ID respectively. Figure 2 (a) Experimental data from Figure 1 showing an isotopic distribution of a fragment of bovine carbonic anhydrase (b) TID with Z=3 (top) and EID (bottom). TID shift corresponds to maximum value of cross-correlation coefficient (0.954) between the two, (c) snapshot of output listing corresponding to above fragment (y27). (d) Experimental distribution from Figure 1 showing two overlapping distributions (e) Z=3, r=0.74 (f) Z=4, r=0.64; (g) residual after subtracting TID\u2019s of (e) and (f) (h) final output listing. Figure 3 Experimental data from Figure 1 showing an extremely low S/N region of the spectrum that contains 4 overlapping distributions. (a) Raw data (b) Z=20, r=0.68; (c) residual after subtraction of (b); (d) Z=10 (r=0.576), (e) Z=11 (r=0.566) and (f) Z=20 (r=0.65) detected simultaneously; (g) residual after subtraction of (d), (e) and (f); (h) Z=20 (r=0.496); (i) residual of experimental signal after subtraction of (h). Figure 4 Comparison of different charge state determination methods on 775 isotopic distributions from 26 electrospray spectra of myoglobin. Figure 5 (a) EID of myoglobin when Z=16; (b) TID of myoglobin, alignment of the EID with (c) TID shifted by 5; (d) TID shifted by 6 (e) TID shifted by 7; (f) normalized probability of alignment as a function of varying TID indices; (g) alignment of myoglobin IDs using 3150 simulations (100 ions in each simulation); (h) a typical Monte-Carlo generated myoglobin isotopic distribution with only 100 ions. Figure 6 Final monoisotopic mass plot of bovine carbonic anhydrase (The full table of peaks is included in the Supplementary Material section). Article Algorithms for Automatic Interpretation of High Resolution Mass Spectra Parminder Kaur \u2020 \u204e Peter B. O\u2019Connor \u2020 \u204e \u204e poconnor@bu.edu Department of Biochemistry, Mass Spectrometry Resource, Boston University School of Medicine, Boston, Massachusetts, USA \u204e Address reprint requests to Professor P. B. O\u2019Connor, Department of Biochemistry, Mass Spectrometry Resource, Boston University School of Medicine, 670 Albany St., Boston, MA 02118, USA \u204e Also at the Cardiovascular Proteomics Center, 670 Albany St., Boston, MA 02118, USA. \u2020 Also at the Department of Electrical and Computer Engineering, Boston University, 8 St. Mary\u2019s St., Boston, MA 02215, USA. Automated interpretation of high-resolution mass spectra in a reliable and efficient manner represents a highly challenging computational problem. This work aims at developing methods for reducing a high-resolution mass spectrum into its monoisotopic peak list, and automatically assigning observed masses to known fragment ion masses if the protein sequence is available. The methods are compiled into a suite of data reduction algorithms which is called MasSPIKE (Mass Spectrum Interpretation and Kernel Extraction). MasSPIKE includes modules for modeling noise across the spectrum, isotopic cluster identification, charge state determination, separation of overlapping isotopic distributions, picking isotopic peaks, aligning experimental and theoretical isotopic distributions for estimating a monoisotopic peak\u2019s location, generating the monoisotopic mass list, and assigning the observed monoisotopic masses to possible protein fragments. The method is tested against a complex top-down spectrum of bovine carbonic anhydrase. Results of each of the individual modules are compared with previously published work. The wide employment of Fourier Transform Mass Spectrometry (FTMS) [1, 2] instruments for Matrix Assisted Laser Desorption/Ionization (MALDI) [3] and Electrospray Ionization (ESI) [4] experiments results in thousands of high-resolution mass spectra every day, creating an information overload. Due to the high mass accuracy and resolving power of an FTMS, MALDI-FTMS [5\u20137] and ESI-FTMS [8, 9] are becoming the instruments of choice for proteomics [10], and experiments on proteins and large fragments of proteins, so called \u201ctop-down\u201d [11\u201314] mass spectrometry. These experiments tend to slow down due to the lack of sophisticated methods for automatic spectrum analysis. Currently, spectrum interpretation is one of the biggest bottlenecks in a proteomics experiment. Manual interpretation of such complex data is very tedious and time consuming. While some instrument manufacturers have developed reasonably effective programs for this problem, they rarely publish these algorithms, and thus the strengths and limitations of these methods are difficult or impossible to assess. Hence, there is need for the development of advanced data analysis algorithms [15\u201321]. In this work, several new algorithms are discussed that allow for the improved automated reduction of high-resolution mass spectra into a monoisotopic peak list. The proposed name for the unified suite of methods is Mass Spectrum Interpretation and Kernel Extraction (MasSPIKE). The m/z ratio of most ESI product ions lies in the range of 500\u20135000 Daltons. Since the same mass can have multiple charge states and there can be multiple isotopic peaks at each nominal m/z value, a very dense, complicated spectrum can be generated. The first attempt for automated spectrum interpretation was (somewhat erroneously) called \u201cdeconvolution\u201d [15\u201317, 20]. \u201cDeconvolution\u201d was based upon the principle that charge states can take only integer values. It combined peaks of the same mass but different charge states to determine the mass of the ion. Currently, most of the published \u201cdeconvolution\u201d algorithms result in spurious peaks due to mis-assignment of charge states. Furthermore, these methods generally perform poorly with low S/N and complex spectra resulting in missed peaks (false negatives). Also, most \u201cdeconvolution\u201d methods bias against peaks represented by only one charge state which will be poorly represented in these deconvolution approaches, though the Z score [20] algorithm does not suffer from this drawback. To overcome these limitations, Horn et al. developed a computer algorithm called THRASH [21] (Thorough High Resolution Analysis of Spectra by Horn). THRASH was the first comprehensive \u201cnon-deconvolution\u201d algorithm that addressed the problem of reducing a complex mass spectrum into a mass list with minimal human intervention. It combines various modules of signal to noise (S/N) calculation, charge state determination using the Fourier/Patterson [19] method, and least-squares fitting for determination of monoisotopic mass. It was a remarkable step towards automated spectrum interpretation and represents the current benchmark in the field. However, THRASH is based upon certain modules that can be approached differently to achieve significantly better results. The work presented here aims to develop better individual modules, and then combine them for improved data reduction. The comparative results are presented in each section. Experimental The methods are presented here, but their performance characteristics will be discussed below. All the methods are being integrated as part of the open source software package BUDA, [22], and will be available at www.bumc.bu.edu/ftms. MasSPIKE starts with modeling the mean of the noise across the selected m/z range of the spectrum. It then identifies isotopic distributions, marks their location, and determines the charge state for each of the identified isotopic distributions to map m/z values to corresponding mass values. Overlapping isotopic distributions are then separated, and the charge state is assigned to each of the resolved overlapping distributions. Then, each experimental isotopic distribution (EID) is aligned with its theoretical isotopic distribution (TID) to arrive at the best alignment index for the two distributions. Finally, the monoisotopic mass for each of the resolved isotopic clusters is calculated using results from the previous steps, and the final, minimal, monoisotopic peak list is generated. The mathematical basis of each of these methods is discussed, and the critical equations are \u201cboxed\u201d for the convenience of the reader. Modeling Noise Baseline noise in a Fourier transform mass spectrum typically has white noise characteristics. Other sources of noise include random electronic RF (Radio Frequency) interference peaks and chemical noise due to unevaporated solvent clusters, which may make the noise look non-white. To detect peaks, it is critical to know noise levels in a particular region of spectra in the m/z domain. This module aims at modeling the mean of the noise. To calculate the S/N ratio across the spectrum, noise mean is characterized as follows. 1 Find the mean of the signal every 1 Da, with 0.5 Da overlap between consecutive m/z windows to assure completeness 2 Every 10 Da (value can be changed by user), the window with the minimum mean is assumed to be the noise window 3 A histogram of the intensity values in the noise window is plotted. The histogram is then truncated to eliminate high intensity values caused by signal or RF interference noise peaks, i.e., the histogram is truncated once the intensity occurrence values reach less than 5% of the maximum occurrence value. Then the mean of the intensity values corresponding to the truncated histogram is calculated and this value is defined as the local noise value. This process is done iteratively until the mean converges. A typical example of this procedure is shown in Figure 1a and b. Note that this procedure does not take into account RF interference peaks, but is designed to find the baseline noise level. RF interference peaks will be filtered out in the subsequent modules to eliminate false positives. Isotopic Distribution Identification The goal here is to identify the locations of isotopic distributions (IDs) based upon the S/N ratio in the spectrum. Here, an ID is identified based upon the fact that S/N ratio for an ID is higher than a particular user defined threshold. This principle is similar to that used in THRASH [21], but this module defines the isotopic distribution boundaries before assigning the charge state, instead of taking a \u00b10.5 Da window around the highest intensity peak. This step is very important for good performance of charge state determination. It is carried out by the following steps: 1 Scan the spectrum every 1 m/z unit from low m/z to high m/z 2 Check S/N in every 1 m/z window 3 S/N = max(signal)/mean(noise), with noise value defined as above 4 If S/N is greater than the user-defined threshold (default value = 3), mark the window as potentially containing an ID 5 Combine together consecutive potential ID windows and output: C1 (start ID m/z value), C2 (end ID m/z value) 6 If there is only one peak within {C1, C2} with S/N greater than the threshold, it typically indicates an RF interference noise peak and is discarded, because real mass spectral peaks almost always have an isotopic signature Note that C1 and C2 are those values of m/z where the S/N hits the threshold value in the window first and last respectively. A table of {C1, C2} values is constructed and used as input to the charge state determination routine. A bovine carbonic anhydrase \u201ctop-down\u201d spectrum (Figure 1a) was used to test MasSPIKE, and will be discussed below. {C1, C2} values for m/z region of 1103\u20131133 from this spectrum are plotted in Figure 1c as arrows below the spectrum with the \u201cup\u201d arrows indicating the start, C1, and \u201cdown\u201d arrows indicating the end, C2, of individual IDs. If the threshold value is kept too low, some random noise spikes may be picked, while too high value will miss the low S/N isotopic distributions. So a value of threshold = 3 was found empirically to be an optimal balance between the two cases, but it can also be adjusted manually by the user. Charge State Determination Each entry in the {C1, C2} table constructed above is subjected to the process of charge state determination. Previously this problem has been approached by taking the Fourier Transform, Patterson, and combination [19] charge state maps (Z-maps) of the isotopic distribution. These methods generally work well with good signals, but all charge state determination methods fail under conditions of low S/N or overlapping IDs so that these methods should be compared against each other under those conditions. In addition, a new method using the Matched Filter [23, 24] approach has been developed and compared to the previous methods in the Discussion section. The Matched Filter (MF) Method for Charge State Determination In charge state determination, the goal is to design a detector for a specific known pattern (in this case, the theoretical isotopic distribution for a particular molecular weight while varying the charge state). In pattern recognition literature, a standard method for approaching this problem is the use of a matched filter [24]. Let E = vector representing experimental isotopic distribution (EID), T = matrix with Nz (number of possible charge states) rows, such that: Zth row of T, T(Z), is a vector representing the theoretical isotopic distribution (TID) for a given charge state Z. T(Z) is constructed as follows. An approximate average molecular weight (MWapprox) can be calculated from the location of EID and the charge state, Z, under consideration (MWapprox = m/z x Z, where m/z is the location of the center of the EID under investigation). For a given MWapprox, elemental composition is determined using the average composition of a model amino acid, averagine [18]. Based on the elemental composition, the Mercury [25] algorithm is used to generate the peak intensities of the TID. Peak width at half height for generating the TID is determined from EID, the value being the same as that of the highest peak of the EID. Knowing the peak heights and the width, each peak is generated assuming a Lorentzian [1] peak shape. The TID is finally generated as the sum of individual Lorentzian peaks. Given an observation E, T(Z) vectors, for all the different possible Z values, are generated as discussed above, for each charge state Z, the matched filter output is then calculated as follows: (1) M ( Z , n ) = \u2211 k = \u2212 L L E ( k ) T ( Z , k \u2212 n ) where L is the maximum of the lengths of E and T. This is equivalent to (2) M ( Z , n ) = E ( n ) \u2217 T ( Z , \u2212 n ) where * denotes the convolution operator. Note that this is also equivalent to taking a cross-correlation of the EID and TID. Define (3) M max \u2061 ( Z ) = max \u2061 M n ( Z , n ) (4) N ( Z ) = arg \u2062 max \u2061 M n ( Z , n ) where arg maxn(M(Z,n)) indicates the value of n that corresponds to the maximum value of M(Z,n). Since the signal intensities and length of E may vary highly in a given experiment, it is important to normalize both E and T while calculating the \u201cscore\u201d of closeness of E and T(Z). This \u201cscore\u201d is given by the value of cross-correlation coefficient r(Z), which is given by the following expression: (5) r ( Z ) = \u03a3 i ( E ( i ) \u2212 M E ) ( T ( Z , i \u2212 N ( Z ) ) \u2212 M T ( Z ) ) \u03a3 i ( E ( i ) \u2212 M E ) 2 \u03a3 i ( T ( Z , i \u2212 N ( Z ) ) \u2212 M T ( Z ) ) 2 where ME and MT(Z) are the means of E and T(Z) respectively. The theory of matched filters [24] tells us that the value of r(Z) will be maximum when E and T(Z) belong to the same class, which in this case means that they represent the same Z. So the charge state is estimated as follows: (6) Z e s t = arg \u2061 max \u2061 r Z ( Z ) This means that the charge state that corresponds to the maximum value of r(Z) can be assigned as the estimated true charge state. This works satisfactorily provided the given input signal E is composed of only one charge state. In practice, a given input signal may represent multiple isotopic distributions of different charge states. Thus, the Z values corresponding to r(Z) greater than a certain user-defined threshold are assigned to be the true charge states. Isotopic cluster(s) corresponding to the above determined charge state(s) are then subtracted from the observed distribution, and the residual signal undergoes the same procedure to look for any more charge states represented by the residual data similar to the procedure used by THRASH. The process continues till the final residual cannot be assigned any charge state since r(Z) value is below the threshold for all values of Z. The procedure for determining useful threshold values is discussed below. Alignment Between Theoretical and Experimental Isotopic Distribution A mass spectrum does not generate a unique mass value for large molecules due to the presence of multiple isotopes of the constituent elements. So the question arises as to what mass value should be reported. One way is to report the chemical average mass using average of isotopic peaks, but this suffers from the problem that carbon isotope variability across different organisms limits the mass accuracy [26, 27] to about 10 ppm. The most significant and accurate mass that can be reported is the monoisotopic mass because its value is unaltered by isotopic variability. The monoisotopic mass (M) of a molecule is the sum of the masses of the lowest mass isotope for each of the elements present in the molecule. The relative abundance of the monoisotopic peak decreases with increase in the molecular weight because of the increased probability for the presence of heavier isotopes with increasing molecular mass. The monoisotopic peak is typically not visible experimentally when molecular weight is higher than 5 kDa because the tiny peak is buried in the noise. Thus, there is need for the development of a method that can estimate the monoisotopic mass based upon the experimentally observed isotopic profile. Previously, this problem was approached by Senko et al. [18] and Horn et al. [21] using a least-squares fit between the theoretical and experimental isotopic distribution. This method generally works well, but breaks down in the limit of low number of ions or low S/N ratio. This module targets at solving this problem rigorously by analyzing the isotopic distributions. As discussed previously, [28] the EID can be interpreted as a result of a multinomial experiment (with the number of trials equal to the number of ions) having multiple outcomes, each with probability ti, where ti represents the area of each individual peak in the TID (i.e., t0 fraction of the total ions in the cell contains no higher isotopes, t1 fraction of the total ions contain exactly one +1 Dalton higher isotope (e.g., 13C), etc.). Let vector E represent EID peaks areas, where ei corresponds to ti in the TID. E is a Gaussian random vector with mean T and covariance matrix \u03a3N (eq 8), where T is composed of tis, and is obtained using the poly-averagine [18] model and the Mercury [25] algorithm. The probability of observing E, given that the number of ions in the cell is N, is the given by [29]: (7) P ( E | N ) = e \u2212 0.5 ( E \u2212 T ) \u0313 \u03a3 N \u2212 1 ( E \u2212 T ) ( 2 \u03c0 ) n d e t ( \u03a3 N ) where \u03a3N is given by the following expression: (8) \u03a3 N = 1 N ( t 1 ( 1 \u2212 t 1 ) \u2212 t 1 t 2 \u2026 \u2212 t 1 t n \u2212 t 2 t 1 t 2 ( 1 \u2212 t 2 ) \u2026 \u2212 t 2 t n . . \u2026 . . . \u2026 . \u2212 t n t 1 \u2212 t n t 2 \u2026 t n ( 1 \u2212 t n ) ) where tis are the components of T, defined by the theoretical isotopic abundances. For big molecules, only a part of E is observed. The goal, therefore, is to align it with the appropriate indices of T to determine the monoisotopic mass. Thus: (9) P ( E | N , i ) = e \u2212 0.5 ( E \u2212 T i ) \u0313 \u03a3 N i \u2212 1 ( E \u2212 T i ) ( 2 \u03c0 ) n d e t ( \u03a3 N i ) which means that E is a normal (Gaussian) random vector with mean Ti and covariance matrix \u03a3i (both mean and covariance matrix vary with the index). The index of T corresponding to first \u201cvisible\u201d value of E is estimated using a Maximum Likelihood estimator as follows: (10) index = arg \u2061 max \u2061 P i ( E | T i , \u03a3 N i ) where (11) T i = T ( i , \u2026 , i + L E \u2212 1 ) LE = length of E. This means that the first LE values of T are aligned with E, calculate the probability of its occurrence from expression 9, and then T is shifted by 1, until all the possibilities have been considered. The shift of T that corresponds to the highest value of the probability is assigned to be the true index of the first observed value of E. This procedure is illustrated in detail in the Results and Discussion section. Finally, the monoisotopic mass (M) is calculated as following: (12) M = m 1 z \u00d7 Z e s t \u2212 ( i n d e x \u2212 1 ) \u00d7 1.00235 \u2212 Z e s t \u00d7 M + where m 1/z is the location of the first \u201cvisible\u201d isotopic peak in the EID (i.e., peak location corresponding to E ((1), Zest is the estimated charge state (eq 6), 1.00235 is the average mass difference between the centroid of each adjacent isotopic peak for poly-averagine [21], and M+ is the mass of the charge carrier (e.g., 1.0073 for a proton). Assuming the experiment was run in a positive ion mode, a charge state of Z usually means the ion carries Z protons, so the corresponding mass of Z protons (default) is subtracted to get M. Results and Discussion Figure 1a shows a top down spectrum of carbonic anhydrase against which MasSPIKE has been tested. Figure 1b shows zoomed-in view of the baseline of Figure 1a and noise mean variation as a function of m/z (white line passing through the baseline). The plot is consistent with the variation of baseline noise in the spectrum. Noise modeling serves to provide a noise mean value to be used in S/N calculation for the identification of ID locations. Note that noise is not truly white (flat across m/z range), which is due to the \u201cchemical noise\u201d effect caused by unevaporated solvent clusters formed by the electrospray source. Figure 1c shows the result of the ID identification module applied to one low S/N region of the spectrum. Figure 1c shows the ID boundaries for the m/z range of 1103\u20131132 with up and down arrows indicating the start and end of an ID respectively. Very closely spaced IDs (e.g., between m/z 1114 and 1117) are not separated as seen in the figure. Such cases and overlapping distributions are separated later in the charge state determination routine. ID determination allows MasSPIKE to identify the IDs representing both low and high charge states without bias. This method was found to correct a limitation of THRASH, which uses \u00b10.5 m/z window around the maximum intensity peak for the charge state determination, restricting the analysis to charge states greater than 2. MasSPIKE, therefore, can be used for both MALDI (typically representing 1+ or perhaps 2+ charge states) and electrospray (typically representing high charge states) spectra. Also, THRASH assumes that the isotopic distribution has a symmetrical Gaussian shape around the highest peak, which holds true for molecular weights greater than \u223c5 kDa, while MasSPIKE makes no such assumption, so is suited for any kind of ID shape. One of the major challenges encountered in the interpretation of dense, complex spectra is that there is a high chance that the peak of interest is affected by interfering noise peaks or peaks from other signal components (e.g., other isotopic distributions). Figure 2 shows a simple case when input signal EID (Figure 2a) represents only Z = 3. Figure 2b shows the plot of T(3) (shifted up) and EID, with shift in T(3) corresponding to maximum value of cross-correlation coefficient (0.954) between the two. Note that r(Z) varies from 0 to 1, so r(3) = 0.954 indicates a very good match between EID and T(3). The output list from MasSPIKE, Figure 2c, shows the starting and ending values of the distribution (smz, emz), the charge state (Z), the assigned amino acid residue region (Res, given the sequence) and ion type (Ion), as well as the observed monoisotopic ion mass (MIO), theoretical ion mass (MIT), and the mass error in Daltons. However, this is an easy case with good S/N ratio, and no overlapping distributions. The real test of automated analysis methods comes at low S/N with distorted peak shapes. Figures 2 and 3 show a couple of such cases extracted from Figure 1a. It is important to note that Figures 2 and 3 are drawn on the same vertical scale as Figure 1a (which is normalized to 100). Thus, Figures 2 and 3, with the highest intensity values in the 3-15 range, represent parts of the spectrum where the S/N ratio is the lowest, and in particular, Figure 3 depicts a case where input signal came from one of the noisiest portions of the spectrum. Figure 2d shows the case when input signal represents two charge states (Z = 3 and Z = 4), which share a central peak at m/z = 912.3. The two charge states are successfully identified and subtracted from the input signal as shown, with TID shifted and plotted on the top of the EID. Note that here MasSPIKE is simultaneously detecting Z = 3 and 4 (Figure 2e and f) and the residual after subtraction is free of peaks (Figure 2g). By comparison, THRASH proceeds by identifying the charge state represented by the combo [19] routine, and then subtracts the TID from the experimental data. With such an approach, if any of the Z = 3 or Z = 4 is detected by the combo routine (which is likely), the peak at m/z = 912.3 (common peak to both Z = 3 and Z = 4) will be removed and the next charge state will not be assigned because the isotopic pattern is perturbed due to subtraction. MasSPIKE attempts to find all the charge states that give cross-correlation coefficient, r(Z), value greater than a certain threshold (default = 0.45) before carrying out the subtraction. This allows for assignment of a greater number of charge states. Note that assignment of this threshold represents a balance between missing peaks and generation of false positives. The default threshold value of 0.45 was empirically determined to be a moderate value, but this value can also be altered by the user. Figure 3a shows an input signal from region m/z = 1380.7\u20131385.5 of the bovine carbonic anhydrase spectrum. MasSPIKE was used for determination of various charge states present in the signal. In this case, four isotopic distributions are identified with multiple distributions sharing isotopic peaks and the Z = 20 distribution at m/z is identified (Figure 3b) and removed (Figure 3c). For higher charge states, especially when the sampling rate of the spectrum is low (which is the case at higher m/z since sampling rate in m/z domain drops as m/z increases in FTMS instruments), it is sometimes difficult to distinguish between the consecutive charge state values. For example, for the m/z region between 1381.6 and 1383.2 (Figure 3d and e), the method identifies the charge state values to be either 10 or 11 (though 10 is slightly more likely to be true, r = 0.576, than the case of Z = 11 where r = 0.566). In ambiguous cases like this, a flag is marked and it is left for the user to decide about the true charge state based on the knowledge from the protein sequence, or supplementary information from other portions of the spectrum. Furthermore, MasSPIKE identified two more EIDs with Z = 20 in this region of mass spectrum. These masses could not be assigned to a particular fragment ion from the given sequence. However, the approximate difference between the two higher Z = 20 ion masses corresponds to the loss of a water molecule, which commonly appears at high molecular weight. For example, the approximate molecular weight for the EID represented by the m/z region 1383.9\u20131384.9 is 1384.4 \u00d7 20 = 27,688, while that for the m/z region 1383\u20131384 is 1383.5 \u00d7 20 = 27,670. The difference of the two species (27,688\u201327,670 = 18) corresponds to the loss of a water molecule, which suggests the assignment of Z = 20 is correct. Also, the final residual from this region, Figure 3i seems to contain one or two remaining isotopic distributions. This is an artifact that arises due to the imperfect subtraction of TID from EID, and often happens because of the non-ideal peak shapes of the EID in low S/N conditions as seen in Figure 3d and e. Since the residual in Figure 3i contains an artifact and not real signal, no further charge state assignments are generated because MasSPIKE does not yield high enough quality assignment (cross-correlation coefficient, r >0.45) for any further charge states. Note that EID and TID take on negative values in some cases (Figure 3b\u2013i) because both the EID and TID are normalized, which involves subtraction of the mean, while computing their cross-correlation coefficient as shown in eq 5. The Supplementary Material data (which can be found in the electronic version of this article) shows the case when the input signal represents 3 isotopic distributions (Z = 1, 3, and 4), sharing multiple peaks in the region of m/z 1221\u20131227. It is important to test the matched filter method of charge state determination against established methods in an unbiased manner. To this end, 26 electrospray spectra of myoglobin, representing 775 isotopic distributions (resulting from charge states for the whole molecule, water losses and phosphate adducts for the whole protein, and one contaminant species with Z = 1) with S/N of 1\u2013100, were acquired and each m/z region corresponding to Z = 1\u201322 in each spectrum (regardless of the presence/absence of signal) was analyzed by four different methods. The percentage correct answers for each method are plotted in Figure 4. BUDA (Boston University Data Analysis) [22] was used to determine the charge states using the Fourier, Patterson, and combo charge state determination methods [19]. In this analysis, the MF method gave correct answers 91% of the time. Of the missed 77 assignments, manual post analysis showed no apparent signal in 50 of them, and the remaining 27 misassigned the charge state by \u00b11. There are certain points that need to be addressed while generating the TID. Generating good model distributions is the key to good results. Although the sampling rate is constant in the frequency domain, due to the inverse proportionality relation between frequency and m/z, the sampling rate of an FT mass spectrum is not the same over the whole m/z range, it decreases with an increase in m/z. Thus, parameters for generating good model distributions (peak width, sampling rate, maximum and minimum possible Z (MAXZ and MINZ)), must vary with the mass spectral region of interest, and in MasSPIKE they are based upon the observed data and shift through the m/z range. Furthermore, it is important to use unapodized spectra, zero filled once for the experimental data and true line shapes for the TIDs to generate the best matches. For the TID model, the peak width for generating the Lorentzian peaks in the TID is defined by the width of the highest peak in the EID. MINZ is defined by the observed isotopic distribution width. e.g., If the EID spans 1.1 Da, MINZ = 1 but if the EID is only 0.9 Da wide, MINZ = 2, so that it contains at least two peaks. This helps eliminate most of the RF interference noise peaks which usually consist of a single high spike. Also, special consideration is given to the number of TID peaks involved in the resulting cross-correlation coefficient. For example, if there is only one peak of the TID matching with the EID that results in the maximum cross-correlation value, it is discarded as a false positive, since it is highly unlikely for biomolecules to have an isotopic distribution with only one peak. MAXZ is defined by the peak width of highest peak, e.g., Peak Width at Half Height < (1/Maximum Z). Sometimes, when there are many noise peaks around the main peak, a false identification for a high charge state is generated. Filters have been added to remove these false positives by comparing the peaks of Fourier charge state maps of the theoretical and experimental data. Also, it is required that for a particular molecular weight, the observed isotopic distribution should be wide enough to represent the peaks that are of intensity at least 60% or greater than the maximum intensity. For example, for an observed distribution of molecular weight 10,000, the distribution should be wide enough to encompass at least 5 peaks (>60% of maximum intensity). Otherwise, it most likely arises as a false positive. These considerations lead to reduced number of false positives and overall better performance. Figure 5 demonstrates the alignment of a typical experimental isotopic distribution (Figure 5a) with the theoretical isotopic distribution (Figure 5b). The EID and TID are represented by grey and black stick plots respectively in Figure 5c\u2013e. Figure 5c\u2013e shows the alignment of the EID with the TID, with the TID being shifted by 5, 6, and 7 in Figure 5c, d, and e, respectively. Figure 5f shows the probability of alignment of the EID against the TID with varying shift of TID. A shift of 6 in the TID gives the best alignment as depicted in Figure 5d and 5h. The normalized probability plot (Figure 5h) shows that the probability the EID and the TID are aligned properly when the shift is 6 is much higher than its nearest-neighbor (index = 5). These results are typical with such high S/N (\u223c20) clean isotopic distributions. However, all alignment methods will work well under these conditions. It is important to test these methods under low S/N and low ion count conditions where large statistical variance occurs in isotopic abundance [28]. When only 100 ions are present in the isotopic distribution, large statistical variation in the isotopic abundance occurs; a typical 100 ion isotopic distribution for myoglobin (16.7 kDa, 16+) is shown in Figure 5g. To test the ML method versus the least-squares method, 3150 Monte Carlo simulated distributions were generated with only 100 ions per simulation, and the two alignment methods were tested against these distributions. The tests revealed that ML method works correctly 85% of the time, compared to the least-squares error method which gave 76% correct results (Figure 5h). Note that it is more difficult to estimate the true index when the distribution is generated by a fewer number of ions since the EID deviates from the TID due to high variance among the isotopic peaks as discussed in our previous work [28]. After the determination of monoisotopic masses (as discussed above), it is desirable to automatically assign the protein fragments that generated those masses. This requires the knowledge of how a protein or peptide fragments in an experiment [30]. MasSPIKE was used to generate theoretical masses of the b and y ions. Internal fragment masses and masses with common losses (e.g., water loss from a molecule) were calculated knowing the sequence of the protein. The observed masses that match with the theoretical masses of the whole protein and its fragments are then evaluated. A complete analysis of the bovine carbonic anhydrase spectrum revealed the presence of 165 isotopic clusters after eliminating all false positives, which were matched to the closest masses of b or y ions, the corresponding internal fragment ions, and some common losses like water loss, or ammonia loss from a y-ion. The complete de-convolved spectrum representing monoisotopic masses is shown in Figure 6. Only abundant peaks are labeled, but the complete monoisotopic mass list is included in the supplemental data (which can be found in the electronic version of this article). Due to the high-energy used for fragmentation, the precursor ion is not observed. One important limitation of MasSPIKE at this time is the assumption implicit in the poly-averagine model, specifically that the molecule of interest is an \u201caverage\u201d protein. Clearly, this assumption fails routinely. A future modification to MasSPIKE will include a DNA and Glycan model as well as the ability to adjust the model manually. Conclusions MasSPIKE (Mass Spectrum Interpretation and Kernel Extraction), a suite of data analysis algorithms, has been developed. The goal is to reduce a high-resolution mass spectrum into a monoisotopic peak list. MasSPIKE identifies isotopic peak cluster locations, determines the charge state for each of the isotopic clusters, resolves overlapping isotopic distributions, aligns the experimental and theoretical distributions, and generates a monoisotopic mass list. If the protein sequence is available, the calculated masses are matched for possible assignments. The method has been applied and tested against complex top-down spectra of bovine carbonic anhydrase. The isotopic distribution identification method is able to identify and mark locations corresponding to both low and high charge states. The Matched Filter charge state determination routine worked correctly 91% of the time for unbiased test data as compared to the standard routines [19], which vary from 48\u201364% accuracy. MasSPIKE is capable of identifying multiple charge states in the input signal sharing multiple peaks. Alignment of the theoretical and experimental isotopic distributions with only 100 ions (and hence, high statistical variance) in the distribution gave 85% correct results as compared to 76% given by the least-squares fitting method. Acknowledgments The authors gratefully acknowledge Professor W. Clem Karl and Dr. Amit Juneja for their valuable suggestions for the design of MasSPIKE, Dr. Bogdan Budnik and Dr. Judith Jebanathirajah for scientific discussions, Dr. Cheng Zhao, Jason Cournoyer, Raman Mathur, Dr. Cheng Lin, Vera Ivleva, and Konstantin Aizikov for experimental assistance, and Dr. Alan Rockwood for sharing the Mercury algorithm source code. This work was supported in part by Federal funds from the National Center for Research Resources under grant no. P41-RR10888 and the National Heart, Lung, and Blood Institute under contract no. HHSN268200248178C, and the American Chemical Society. Supplementary data Supplementary figure Supplementary Material Figure (a) EID of a Bovine Carbonic Anhydrase fragment (b) Z=4, r=0.731 (c) Residual after subtraction (d) Z=1, r=0.54 (e) Z=3 sharing 2 peaks with (d), r=0.495 (f) Residual after subtraction of assigned charge states. Supplementary Table References 1 A.G. Marshall F.R. Verdun Fourier Transforms in NMROpticaland Mass Spectrometry 1990 Elsevier Amsterdam 2 I.J. Amster Fourier Transform Mass Spectrometry J. Mass Spectrom. 31 1996 1325 1337 3 M. Karas D. Bachmann U. Bahr F. Hillenkamp Matrix-assisted Ultraviolet Laser Desorption of Non-Volatile Compounds Int. J. Mass Spectrom. Ion Phys. 78 1987 53 68 4 J.B. Fenn M. Mann C.K. Meng S.F. Wong C.M. Whitehouse Electrospray Ionization for Mass Spectrometry of Large Biomolecules Science. 246 1989 64 71 5 B.A. Budnik S.C. Moyer J.L. Pittman V.B. Ivleva U. Sommer C.E. Costello P.B. O\u2019Connor High pressure MALDI-FTMS Implications for Proteomics Int. J. Mass Spectrom. Ion Processes. 234 2004 203 212 6 P.B. O\u2019Connor B.A. Budnik V.B. Ivleva P. Kaur S.C. Moyer J.L. Pittman C.E. Costello A High Pressure Matrix-Assisted Laser Desorption Fourier Transform Mass Spectrometry Ion Source Designed to Accommodate Large Targets with Diverse Surfaces J. Am. Soc. Mass Spectrom. 15 2003 128 132 7 S.C. Moyer B.A. Budnik J.L. Pittman C.E. Costello P.B. O\u2019Connor Attomole Peptide Analysis by High Pressure Matrix-Assisted Laser Desorption/Ionization Fourier Transform Mass Spectrometry Anal. Chem. 75 2003 6449 6454 8 K.D. Henry J.P. Quinn F.W. McLafferty High-Resolution Electrospray Mass Spectra of Large Molecules J. Am. Chem. Soc. 113 1991 5447 5449 9 Y.F. Shen N. Tolic R. Zhao L. Pasa-Tolic L.J. Li S.J. Berger R. Harkewicz G.A. Anderson M.E. Belov R.D. Smith High-Throughput Proteomics Using High Efficiency Multiple-Capillary Liquid Chromatography with On-Line High-Performance ESI FTICR Mass Spectrometry Anal. Chem. 73 2001 3011 3021 10 R. Aebersold A Mass Spectrometric Journey into Protein and Proteome Research J. Am. Soc. Mass Spectrom. 14 2003 685 695 11 F.W. McLafferty High Resolution Tandem FT Mass Spectrometry Above 10 kDa Acc. Chem. Res. 27 1994 379 386 12 N.L. Kelleher Top-down Proteomics Anal. Chem. 76 2004 196A 203A 13 N.L. Kelleher H.Y. Lin G.A. Valaskovic D.J. Aaserud E.K. Fridriksson F.W. McLafferty Top Down versus Bottom Up Protein Characterization by Tandem High-Resolution Mass Spectrometry J. Am. Chem. Soc. 121 1999 806 812 14 R.A. Zubarev N.L. Kelleher F. McLafferty Electron Capture Dissociation of Multiply Charged Protein Cations. A Nonergodic Process J. Am. Chem. Soc. 13 1998 3265 3266 15 M. Mann C.K. Meng J.B. Fenn Interpreting Mass Spectra of Multiply Charged Ions Anal. Chem. 61 1989 1702 1708 16 B.B. Reinhold V.N. Reinhold Electrospray Ionization Mass Spectrometry Deconvolution by an Entropy Based Algorithm J. Am. Soc. Mass Spectrom. 3 1992 207 215 17 K.D. Henry F.W. McLafferty Electrospray Ionization with Fourier-Transform Mass Spectrometery. Charge State Assignment from Resolved Isotopic Peaks Org. Mass Spectrom. 25 1990 490 492 18 M.W. Senko S.C. Beu F.W. McLafferty Determination of Monoisotopic Masses and Ion Populations for Large Biomolecules from Resolved Isotopic Distributions J. Am. Soc. Mass Spectrom. 6 1995 229 233 19 M.W. Senko S.C. Beu F.W. McLafferty Automated Assignment of Charge States from Resolved Isotopic Peaks for Multiply Charged Ions J. Am. Soc. Mass Spectrom. 6 1995 52 56 20 Z. Zhang A.G. Marshall A Universal Algorithm for Fast and Automated Charge State Deconvolution of Electrospray Mass-to-Charge Ratio Spectra J. Am. Soc. Mass Spectrom. 9 1998 225 233 21 D.M. Horn R.A. Zubarev F.W. McLafferty Automated Reduction and Interpretation of High Resolution Electrospray Mass Spectra of Large Molecules J. Am. Soc. Mass Spectrom. 11 2000 320 332 22 O\u2019Connor,, P. B. Boston University Data Analysis www.bumc.bu.edu/ftms. 23 S. Haykin Communications Systems 1994 John Wiley and Sons, Inc Singapore 413 418 24 R.O. Duda P.E. Hart D.H. Stork Pattern Classification 2001 Wiley Interscience New York 325 326 25 A.L. Rockwood Ultrahigh-Speed Calculation of Isotope Distributions Anal. Chem. 68 1996 2027 2030 26 R.C. Beavis Chemical mass of carbon in proteins Anal. Chem. 65 1993 496 497 27 R.A. Zubarev P. Hakansson B. Sundqvist Accuracy Requirements for Peptide Characterization by Monoisotopic Molecular Mass Measurements Anal. Chem. 68 1996 4060 4063 28 P. Kaur P.B. O\u2019Connor Use of Statistical Methods for Estimation of Total Number of Charges in a Mass Spectrometry Experiment Anal. Chem. 76 2004 2756 2762 29 H.V. Poor An Introduction to Signal Detection and Estimation (Springer Texts in Electrical Engineering) 2nd ed. 1994 Springer Verlag New York 53 30 P. Roepstorff J. Fohlman Proposal for a Common Nomenclature for Sequence Ions in Mass Spectra of Peptides Biomed. Mass Spectrom. 11 1984 601", "scopus-id": "33344456468", "pubmed-id": "16464606", "coredata": {"eid": "1-s2.0-S1044030505009840", "dc:description": "Automated interpretation of high-resolution mass spectra in a reliable and efficient manner represents a highly challenging computational problem. This work aims at developing methods for reducing a high-resolution mass spectrum into its monoisotopic peak list, and automatically assigning observed masses to known fragment ion masses if the protein sequence is available. The methods are compiled into a suite of data reduction algorithms which is called MasSPIKE (Mass Spectrum Interpretation and Kernel Extraction). MasSPIKE includes modules for modeling noise across the spectrum, isotopic cluster identification, charge state determination, separation of overlapping isotopic distributions, picking isotopic peaks, aligning experimental and theoretical isotopic distributions for estimating a monoisotopic peak\u2019s location, generating the monoisotopic mass list, and assigning the observed monoisotopic masses to possible protein fragments. The method is tested against a complex top-down spectrum of bovine carbonic anhydrase. Results of each of the individual modules are compared with previously published work.", "openArchiveArticle": "true", "prism:coverDate": "2006-03-31", "openaccessUserLicense": "http://www.elsevier.com/open-access/userlicense/1.0/", "prism:aggregationType": "Journal", "prism:url": "https://api.elsevier.com/content/article/pii/S1044030505009840", "dc:creator": [{"@_fa": "true", "$": "Kaur, Parminder"}, {"@_fa": "true", "$": "O\u2019Connor, Peter B."}], "link": [{"@_fa": "true", "@rel": "self", "@href": "https://api.elsevier.com/content/article/pii/S1044030505009840"}, {"@_fa": "true", "@rel": "scidir", "@href": "https://www.sciencedirect.com/science/article/pii/S1044030505009840"}], "dc:format": "application/json", "openaccessType": "Full", "pii": "S1044-0305(05)00984-0", "prism:volume": "17", "prism:publisher": "American Society for Mass Spectrometry. Published by Elsevier B.V.", "dc:title": "Algorithms for Automatic Interpretation of High Resolution Mass Spectra", "prism:copyright": "Copyright \u00a9 2006 American Society for Mass Spectrometry. Published by Elsevier B.V. All rights reserved.", "openaccess": "1", "prism:issn": "10440305", "prism:issueIdentifier": "3", "openaccessArticle": "true", "prism:publicationName": "Journal of the American Society for Mass Spectrometry", "prism:number": "3", "openaccessSponsorType": "ElsevierBranded", "prism:pageRange": "459-468", "prism:endingPage": "468", "pubType": "Article", "prism:coverDisplayDate": "March 2006", "prism:doi": "10.1016/j.jasms.2005.11.024", "prism:startingPage": "459", "dc:identifier": "doi:10.1016/j.jasms.2005.11.024", "openaccessSponsorName": null}, "objects": {"object": [{"@category": "thumbnail", "@height": "34", "@width": "350", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si12.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "1331", "@ref": "si12", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "26", "@width": "199", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si10.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "895", "@ref": "si10", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "53", "@width": "196", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si9.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "1372", "@ref": "si9", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "123", "@width": "318", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si8.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "3507", "@ref": "si8", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "52", "@width": "179", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si7.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "1282", "@ref": "si7", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "25", "@width": "133", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si6.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "606", "@ref": "si6", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "72", "@width": "343", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si5.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "2860", "@ref": "si5", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "26", "@width": "171", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si4.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "811", "@ref": "si4", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "26", "@width": "164", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si3.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "766", "@ref": "si3", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "15", "@width": "150", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si11.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "489", "@ref": "si11", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "15", "@width": "178", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si2.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "693", "@ref": "si2", "@mimetype": "image/gif"}, {"@category": "thumbnail", "@height": "37", "@width": "204", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-si1.gif?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "ALTIMG", "@size": "972", "@ref": "si1", "@mimetype": "image/gif"}, {"@category": "standard", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-mmc1.pdf?httpAccept=%2A%2F%2A", "@multimediatype": "Acrobat PDF file", "@type": "APPLICATION", "@size": "29038", "@ref": "mmc1", "@mimetype": "application/pdf"}, {"@category": "standard", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-mmc2.pdf?httpAccept=%2A%2F%2A", "@multimediatype": "Acrobat PDF file", "@type": "APPLICATION", "@size": "216369", "@ref": "mmc2", "@mimetype": "application/pdf"}, {"@category": "standard", "@height": "588", "@width": "342", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr5.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "56378", "@ref": "gr5", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "93", "@width": "54", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr5.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "1147", "@ref": "gr5", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "337", "@width": "339", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr4.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "35662", "@ref": "gr4", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "93", "@width": "94", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr4.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "1485", "@ref": "gr4", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "323", "@width": "367", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr6.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "44867", "@ref": "gr6", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "93", "@width": "106", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr6.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "2170", "@ref": "gr6", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "699", "@width": "357", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr1.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "68200", "@ref": "gr1", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "92", "@width": "47", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr1.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "1420", "@ref": "gr1", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "1431", "@width": "596", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr3.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "137037", "@ref": "gr3", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "94", "@width": "39", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr3.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "867", "@ref": "gr3", "@mimetype": "image/gif"}, {"@category": "standard", "@height": "583", "@width": "357", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr2.jpg?httpAccept=%2A%2F%2A", "@multimediatype": "JPEG image file", "@type": "IMAGE-DOWNSAMPLED", "@size": "59983", "@ref": "gr2", "@mimetype": "image/jpeg"}, {"@category": "thumbnail", "@height": "93", "@width": "57", "@_fa": "true", "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S1044030505009840-gr2.sml?httpAccept=%2A%2F%2A", "@multimediatype": "GIF image file", "@type": "IMAGE-THUMBNAIL", "@size": "1017", "@ref": "gr2", "@mimetype": "image/gif"}]}, "link": {"@rel": "abstract", "@href": "https://api.elsevier.com/content/abstract/scopus_id/33344456468"}}